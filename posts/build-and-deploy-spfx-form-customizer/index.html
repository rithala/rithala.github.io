<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Build and deploy SPFx form customizer | Kamil Rithaler</title><meta name=keywords content="SharePoint,SPFx,TypeScript"><meta name=description content="Today Microsoft released the latest version of SPFx (v1.15). This version comes with the feature that I waited most for (and probably many SharePoint developers). This is a possibility to create a &ldquo;native&rdquo; list item custom form.
Until this day, it was a very hacky process of making a custom webpart and redirecting users to it by using custom actions or list view JSON customizers. Now, this development model is fully supported by SPFx."><meta name=author content="Kamil Rithaler"><link rel=canonical href=https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/><link crossorigin=anonymous href=/assets/css/stylesheet.48fe8868200bb9109f48654c3725b1f1926ea1c4266b0af0728dff9e74283371.css integrity="sha256-SP6IaCALuRCfSGVMNyWx8ZJuocQmawrwco3/nnQoM3E=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://rithala.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://rithala.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://rithala.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://rithala.github.io/apple-touch-icon.png><link rel=mask-icon href=https://rithala.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-9X7D34Q60Z"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9X7D34Q60Z",{anonymize_ip:!1})}</script><meta property="og:title" content="Build and deploy SPFx form customizer"><meta property="og:description" content="Today Microsoft released the latest version of SPFx (v1.15). This version comes with the feature that I waited most for (and probably many SharePoint developers). This is a possibility to create a &ldquo;native&rdquo; list item custom form.
Until this day, it was a very hacky process of making a custom webpart and redirecting users to it by using custom actions or list view JSON customizers. Now, this development model is fully supported by SPFx."><meta property="og:type" content="article"><meta property="og:url" content="https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/"><meta property="og:image" content="https://rithala.github.io/images/form_new.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-22T14:33:33+02:00"><meta property="article:modified_time" content="2022-06-22T14:33:33+02:00"><meta property="og:site_name" content="Kamil Rithaler BLOG"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rithala.github.io/images/form_new.png"><meta name=twitter:title content="Build and deploy SPFx form customizer"><meta name=twitter:description content="Today Microsoft released the latest version of SPFx (v1.15). This version comes with the feature that I waited most for (and probably many SharePoint developers). This is a possibility to create a &ldquo;native&rdquo; list item custom form.
Until this day, it was a very hacky process of making a custom webpart and redirecting users to it by using custom actions or list view JSON customizers. Now, this development model is fully supported by SPFx."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://rithala.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Build and deploy SPFx form customizer","item":"https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Build and deploy SPFx form customizer","name":"Build and deploy SPFx form customizer","description":"Today Microsoft released the latest version of SPFx (v1.15). This version comes with the feature that I waited most for (and probably many SharePoint developers). This is a possibility to create a \u0026ldquo;native\u0026rdquo; list item custom form.\nUntil this day, it was a very hacky process of making a custom webpart and redirecting users to it by using custom actions or list view JSON customizers. Now, this development model is fully supported by SPFx.","keywords":["SharePoint","SPFx","TypeScript"],"articleBody":"Today Microsoft released the latest version of SPFx (v1.15). This version comes with the feature that I waited most for (and probably many SharePoint developers). This is a possibility to create a ‚Äúnative‚Äù list item custom form.\nUntil this day, it was a very hacky process of making a custom webpart and redirecting users to it by using custom actions or list view JSON customizers. Now, this development model is fully supported by SPFx.\nIn this article, you will get to know how to build a simple form, test it, and deploy it to the site.\nHow to create a form customizer component? Update the SPFx generator to the newest version\nnpm install @microsoft/generator-sharepoint@latest --global Create a new directory for the project and open it in a terminal then run the command\nyo @microsoft/sharepoint Follow the instructions on the screen. The new customization type is available under Extension -\u003e Form Customizer. In this example, I choose to create a React form.\nCreated SPFx project Now the generator will create the project and install all dependencies. When it is done a standard SPFx project structure is created. You can find the customizer in the src/extensions/{customizerName} directory.\nLet‚Äôs jump to the customizer component and see what we got here.\nIt looks very similar to the web part component. There are onInit for initialization, render for rendering the form and onDispose for a clean-up. The new things are displayMode which indicates if it is the display, edit or the new mode, self-explanatory properties like list, contentType or itemId, and formSaved() with formClosed() to tell the SharePoint that we finished the job in our form.\nAs I selected React as my framework, the React form component was created as well. By default, it is a pretty empty place.\nCreating a simple form As the form was created, now it is time to add some logic to it. In this example, there is a very simple list with just a title field. SPFx does not give you an API to get, create or edit a list item. Of course, there is SPHttpClient in the component context and you can build requests to SharePoint REST manually, but it is a verbose task. The more friendly way to do it is to use the @pnp/sp library. Add this library to your project.\nnpm install @pnp/sp --save The library has to be initialized. The best place to do it is the onInit() method of the form customizer.\n// MyFirstSpFxFormFormCustomizer.ts import {spfi, SPFx, SPFI} from '@pnp/sp' ... class MyFirstSpFxFormFormCustomizer extends BaseFormCustomizer\u003cIMyFirstSpFxFormFormCustomizerProperties\u003e { private sp: SPFI; public onInit(): Promise\u003cvoid\u003e { this.sp = spfi().using(SPFx({ pageContext: this.context.pageContext })); return Promise.resolve(); } } Pass the newly created @pnp/sp instance to the React component in the render() method.\n// MyFirstSpFxFormFormCustomizer.ts ... public render(): void { // Use this method to perform your custom rendering. const myFirstSpFxForm: React.ReactElement\u003c{}\u003e = React.createElement( MyFirstSpFxForm, { context: this.context, displayMode: this.displayMode, sp: this.sp, onSave: this._onSave, onClose: this._onClose, } as IMyFirstSpFxFormProps ); ReactDOM.render(myFirstSpFxForm, this.domElement); } The whole form logic is in the React form component. These days I prefer to work with functional components with hooks. So my component now looks like this.\n// MyFirstSpFxForm.tsx export interface IMyFirstSpFxFormProps { context: FormCustomizerContext; displayMode: FormDisplayMode; sp: SPFI; onSave: () =\u003e void; onClose: () =\u003e void; } export default function MyFirstSpFxForm({ context, displayMode, sp, onSave, onClose, }: IMyFirstSpFxFormProps) { return \u003cdiv className={styles.myFirstSpFxForm} /\u003e; } It is much simpler now. Add some generic form logic to it, and it should be similar to this.\n// MyFirstSpFxForm.tsx import { FormDisplayMode } from '@microsoft/sp-core-library'; import { FormCustomizerContext } from '@microsoft/sp-listview-extensibility'; import * as React from 'react'; import { DefaultButton, PrimaryButton } from 'office-ui-fabric-react/lib/Button'; import { Stack } from 'office-ui-fabric-react/lib/Stack'; import { TextField } from 'office-ui-fabric-react/lib/TextField'; import { SPFI } from '@pnp/sp'; import '@pnp/sp/items'; import '@pnp/sp/lists/web'; import '@pnp/sp/webs'; export interface IMyFirstSpFxFormProps { context: FormCustomizerContext; displayMode: FormDisplayMode; sp: SPFI; onSave: () =\u003e void; onClose: () =\u003e void; } interface MyListItem { Id?: number; Title?: string; 'odata.etag'?: string; } export default function MyFirstSpFxForm({ context, displayMode, sp, onSave, onClose, }: IMyFirstSpFxFormProps) { const [listItem, setListItem] = React.useState\u003cMyListItem\u003e({}); const isViewForm = React.useMemo( () =\u003e displayMode === FormDisplayMode.Display, [displayMode] ); const onInputChange = React.useMemo( () =\u003e (e: any, value?: string) =\u003e setListItem({ ...listItem, Title: value }), [listItem, setListItem] ); const saveForm = React.useMemo( () =\u003e () =\u003e { (async () =\u003e { const listItems = sp.web.lists.getById( context.list.guid.toString() ).items; const update = { Title: listItem.Title }; if (!listItem.Title) { return alert('Title is required'); } try { if (!context.itemId) { await listItems.add(update); } else { await listItems .getById(context.itemId) .update(update, listItem['odata.etag']); } onSave(); } catch (error) { alert('Error during saving the list item'); } })(); }, [listItem, context.itemId, context.list.guid, sp] ); React.useEffect(() =\u003e { (async () =\u003e { if (context.itemId) { const item = await sp.web.lists .getById(context.list.guid.toString()) .items.getById(context.itemId)\u003cMyListItem\u003e(); setListItem(item); } else { setListItem({ Title: '' }); } })(); }, [context.itemId, context.list.guid, displayMode, sp]); return ( \u003cStack tokens={{ childrenGap: 15, padding: 15, }} styles={{ root: { maxWidth: 500 } }} \u003e \u003cspan\u003eID: {context.itemId || 'new'}\u003c/span\u003e \u003cTextField label=\"Title\" value={listItem.Title} onChange={onInputChange} readOnly={isViewForm} /\u003e \u003cStack horizontal tokens={{ childrenGap: 5, }} horizontalAlign=\"end\" \u003e {!isViewForm \u0026\u0026 \u003cPrimaryButton onClick={saveForm}\u003eSave\u003c/PrimaryButton\u003e} \u003cDefaultButton onClick={onClose}\u003eClose\u003c/DefaultButton\u003e \u003c/Stack\u003e \u003c/Stack\u003e ); } Debugging the form in a browser The basic form is ready, and we are eager on testing it. Before trying out how the customizer works you need to change the serve configuration. To do this, edit the config/serve.json file and replace all occurrences of https://contoso.sharepoint.com/sites/mySite with the URL of your test site and /sites/mySite/Lists/MyList with the server relative URL of the test list that you are using. Your final config should be similar to this.\nNow you can run the project with\nnpx gulp serve The browser should open a development page asking for allowing debug scripts.\nAfter allowing debug scripts our form should be opened and ready to add a new item.\nFill out the title field and click the save button. The form should be closed and a new item is added to the list. So, we got the first big milestone here! The form has created a list item.\nLet‚Äôs check if the form works correctly in the ‚ÄúView‚Äù mode. Stop the running serve command and run the view form debugging.\nnpx gulp serve --config=myFirstSpFxForm_ViewForm Another successful test! So the last one left. You can try if you can edit an item. Again, stop the serve and run:\nnpx gulp serve --config=myFirstSpFxForm_EditForm The item loads, now try to edit it and save changes.\nIt works! This is your first SPFx form customizer.\nCustomizer deployment To deploy the component you need a content type and update its custom form-related properties. Microsoft introduced these new properties on the content type model:\nProperty Description NewFormClientSideComponentId component id for new form NewFormClientSideComponentProperties optional configuration details EditFormClientSideComponentId component id display form EditFormClientSideComponentProperties optional configuration details DisplayFormClientSideComponentId component id display form DisplayFormClientSideComponentProperties optional configuration details You can use various ways to change the content type properties.\nContent-type as part of SPFx package, Content-type as part of PnP provisioning template, Changing content-type properties with REST or CSOM, PnP PowerShell (limited). In this article, I will show you how to use the last option on the list above. In fact, it is a combination of using PnP PowerShell to get the access token and making an HTTP request to SharePoint REST API manually. For now, there is no built-in method supporting new content type properties.\nThe deployment starts with building the SPFx solution. The SPFx has some very strict linter rules that will stop us from packaging this solution. For this simple PoC purpose add this line to gulpfile.js. Please do not use this in a production environment.\nbuild.addSuppression(/.*/g); Next, you can run this command.\nnpx gulp bundle --ship \u0026\u0026 npx gulp package-solution --ship You can find the build package in the sharepoint/package-name.sppkg directory. Upload the package to a tenant or site-scoped app catalog.\nTo make the customizer on a SharePoint site you need to add the app. On the home page click the ‚Äúnew‚Äù button and select ‚ÄúApp‚Äù.\nOn the next page click the ‚ÄúAdd‚Äù button next to the solution.\nWhen you will see the success alert, go to site settings and select the content-types option. Then create a new content type.\nAfter creating a content type, copy the content-type ID value from the confirmation page.\nLeave the browser for a moment, now it is time for some PowerShell. Connect to a SharePoint site.\nConnect-PnPOnline -Url https://tenantname.sharepoint.com/sites/SiteName -Interactive Get the created content type ID and the component ID from the MyFormCustomizer.manfiest.json file\n$contentTypeId = \"0x01003D4C996DABD4694BA215125F3C268050\" $componentId = \"83b57037-dfde-4ad3-9ab0-0274c6e26193\" $token = Get-PnPAccessToken -ResourceUrl \"https://tenantname.sharepoint.com/.default\" $body = @{NewFormClientSideComponentId = $componentId; EditFormClientSideComponentId = $componentId; DisplayFormClientSideComponentId = $componentId} | ConvertTo-Json Invoke-RestMethod -Method Patch -Uri \"https://tenantname.sharepoint.com/sites/SiteName/_api/web/contenttypes('$contentTypeId')\" -Headers @{ Authorization = \"Bearer $token\"; \"Content-Type\" = \"application/json\" } -Body $body You can close the PowerShell window. Assign the newly created content type to a list. To do this go to List settings -\u003e Advanced settings. Change ‚ÄúAllow management of content types?‚Äù to ‚ÄúYes‚Äù and save changes.\nNow ‚ÄúContent Types‚Äù section in the list settings is visible. Click the ‚ÄúAdd from existing site content types‚Äù action. On the next page select the previously created content type and click ‚ÄúOk‚Äù.\nIt is a good idea to hide the default content type. To do this click the ‚ÄúChange new button order and default content type‚Äù link and change the settings to the following.\nNow you can try it out by creating a new item. The freshly created form customizer should be your new list form ü•≥\nThe tooling at this stage is a little cumbersome. Nevertheless, today is the go-live day of this feature üëç\n","wordCount":"1593","inLanguage":"en","image":"https://rithala.github.io/images/form_new.png","datePublished":"2022-06-22T14:33:33+02:00","dateModified":"2022-06-22T14:33:33+02:00","author":{"@type":"Person","name":"Kamil Rithaler"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/"},"publisher":{"@type":"Organization","name":"Kamil Rithaler","logo":{"@type":"ImageObject","url":"https://rithala.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://rithala.github.io accesskey=h title="Kamil Rithaler (Alt + H)"><img src=https://rithala.github.io/apple-touch-icon.png alt=logo aria-label=logo height=35>Kamil Rithaler</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://rithala.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://rithala.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://rithala.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://rithala.github.io>Home</a>&nbsp;¬ª&nbsp;<a href=https://rithala.github.io/posts/>Posts</a></div><h1 class=post-title>Build and deploy SPFx form customizer</h1><div class=post-meta><span title='2022-06-22 14:33:33 +0200 +0200'>June 22, 2022</span>&nbsp;¬∑&nbsp;8 min&nbsp;¬∑&nbsp;Kamil Rithaler&nbsp;|&nbsp;<a href=https://github.com/rithala/content/posts/build-and-deploy-spfx-form-customizer/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy srcset="https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/images/form_new_hu117340367b53fe4ce825d3aee6936279_12987_360x0_resize_box_3.png 360w ,https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/images/form_new_hu117340367b53fe4ce825d3aee6936279_12987_480x0_resize_box_3.png 480w ,https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/images/form_new_hu117340367b53fe4ce825d3aee6936279_12987_720x0_resize_box_3.png 720w ,https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/images/form_new.png 722w" sizes="(min-width: 768px) 720px, 100vw" src=https://rithala.github.io/posts/build-and-deploy-spfx-form-customizer/images/form_new.png alt="Build and deploy SPFx form customizer" width=722 height=478><p>Build and deploy SPFx form customizer</p></figure><div class=post-content><p>Today <a href=https://docs.microsoft.com/en-us/sharepoint/dev/spfx/release-1.15>Microsoft released the latest version of SPFx (v1.15)</a>. This version comes with the feature that I waited most for (and probably many SharePoint developers). This is a possibility to create a &ldquo;native&rdquo; list item custom form.</p><p>Until this day, it was a very hacky process of making a custom webpart and redirecting users to it by using custom actions or list view JSON customizers. Now, this development model is fully supported by SPFx.</p><p>In this article, you will get to know how to build a simple form, test it, and deploy it to the site.</p><h2 id=how-to-create-a-form-customizer-component>How to create a form customizer component?<a hidden class=anchor aria-hidden=true href=#how-to-create-a-form-customizer-component>#</a></h2><p>Update the SPFx generator to the newest version</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install @microsoft/generator-sharepoint@latest --global
</span></span></code></pre></div><p>Create a new directory for the project and open it in a terminal then run the command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yo @microsoft/sharepoint
</span></span></code></pre></div><p>Follow the instructions on the screen. The new customization type is available under <code>Extension -> Form Customizer</code>. In this example, I choose to create a React form.</p><p><img loading=lazy src=images/yo3.png#center alt="Yeoman generator steps"></p><h3 id=created-spfx-project>Created SPFx project<a hidden class=anchor aria-hidden=true href=#created-spfx-project>#</a></h3><p>Now the generator will create the project and install all dependencies. When it is done a standard SPFx project structure is created. You can find the customizer in the <code>src/extensions/{customizerName}</code> directory.</p><p><img loading=lazy src=images/project_structure.png#center alt="Project structure"></p><p>Let&rsquo;s jump to the customizer component and see what we got here.</p><p><img loading=lazy src=images/component.png#center alt="Form customizer component"></p><p>It looks very similar to the web part component. There are <code>onInit</code> for initialization, <code>render</code> for rendering the form and <code>onDispose</code> for a clean-up. The new things are <code>displayMode</code> which indicates if it is the display, edit or the new mode, self-explanatory properties like <code>list</code>, <code>contentType</code> or <code>itemId</code>, and <code>formSaved()</code> with <code>formClosed()</code> to tell the SharePoint that we finished the job in our form.</p><p>As I selected React as my framework, the React form component was created as well. By default, it is a pretty empty place.</p><p><img loading=lazy src=images/react_component.png#center alt="React default form component"></p><h3 id=creating-a-simple-form>Creating a simple form<a hidden class=anchor aria-hidden=true href=#creating-a-simple-form>#</a></h3><p>As the form was created, now it is time to add some logic to it. In this example, there is a very simple list with just a title field. SPFx does not give you an API to get, create or edit a list item. Of course, there is <code>SPHttpClient</code> in the component context and you can build requests to SharePoint REST manually, but it is a verbose task. The more friendly way to do it is to use the <code>@pnp/sp</code> library. Add this library to your project.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install @pnp/sp --save
</span></span></code></pre></div><p>The library has to be initialized. The best place to do it is the <code>onInit()</code> method of the form customizer.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-TypeScript data-lang=TypeScript><span style=display:flex><span><span style=color:#75715e>// MyFirstSpFxFormFormCustomizer.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> {<span style=color:#a6e22e>spfi</span>, <span style=color:#a6e22e>SPFx</span>, <span style=color:#a6e22e>SPFI</span>} <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@pnp/sp&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyFirstSpFxFormFormCustomizer</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>BaseFormCustomizer</span>&lt;<span style=color:#f92672>IMyFirstSpFxFormFormCustomizerProperties</span>&gt;  {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>sp</span>: <span style=color:#66d9ef>SPFI</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>onInit</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>sp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>spfi</span>().<span style=color:#a6e22e>using</span>(<span style=color:#a6e22e>SPFx</span>({ <span style=color:#a6e22e>pageContext</span>: <span style=color:#66d9ef>this.context.pageContext</span> }));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Promise</span>.<span style=color:#a6e22e>resolve</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Pass the newly created <code>@pnp/sp</code> instance to the React component in the <code>render()</code> method.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-TypeScript data-lang=TypeScript><span style=display:flex><span><span style=color:#75715e>// MyFirstSpFxFormFormCustomizer.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#a6e22e>render</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Use this method to perform your custom rendering.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>myFirstSpFxForm</span>: <span style=color:#66d9ef>React.ReactElement</span><span style=color:#f92672>&lt;</span>{}<span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>createElement</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>MyFirstSpFxForm</span>,
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>this.context</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>displayMode</span>: <span style=color:#66d9ef>this.displayMode</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sp</span>: <span style=color:#66d9ef>this.sp</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onSave</span>: <span style=color:#66d9ef>this._onSave</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onClose</span>: <span style=color:#66d9ef>this._onClose</span>,
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>IMyFirstSpFxFormProps</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ReactDOM</span>.<span style=color:#a6e22e>render</span>(<span style=color:#a6e22e>myFirstSpFxForm</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>domElement</span>);
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>The whole form logic is in the React form component. These days I prefer to work with functional components with hooks. So my component now looks like this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-TypeScript data-lang=TypeScript><span style=display:flex><span><span style=color:#75715e>// MyFirstSpFxForm.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>IMyFirstSpFxFormProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>FormCustomizerContext</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>displayMode</span>: <span style=color:#66d9ef>FormDisplayMode</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sp</span>: <span style=color:#66d9ef>SPFI</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onSave</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onClose</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>MyFirstSpFxForm</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>context</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>displayMode</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sp</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onSave</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onClose</span>,
</span></span><span style=display:flex><span>}<span style=color:#f92672>:</span> <span style=color:#a6e22e>IMyFirstSpFxFormProps</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>styles</span>.<span style=color:#a6e22e>myFirstSpFxForm</span>} /&gt;;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It is much simpler now. Add some generic form logic to it, and it should be similar to this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-TypeScript data-lang=TypeScript><span style=display:flex><span><span style=color:#75715e>// MyFirstSpFxForm.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>FormDisplayMode</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@microsoft/sp-core-library&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>FormCustomizerContext</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@microsoft/sp-listview-extensibility&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DefaultButton</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PrimaryButton</span>
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;office-ui-fabric-react/lib/Button&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Stack</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;office-ui-fabric-react/lib/Stack&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>TextField</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;office-ui-fabric-react/lib/TextField&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>SPFI</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@pnp/sp&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#39;@pnp/sp/items&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#39;@pnp/sp/lists/web&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#39;@pnp/sp/webs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>IMyFirstSpFxFormProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>FormCustomizerContext</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>displayMode</span>: <span style=color:#66d9ef>FormDisplayMode</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sp</span>: <span style=color:#66d9ef>SPFI</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onSave</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onClose</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>MyListItem</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Id?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Title?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;odata.etag&#39;</span><span style=color:#f92672>?:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>MyFirstSpFxForm</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>context</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>displayMode</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sp</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onSave</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onClose</span>,
</span></span><span style=display:flex><span>}<span style=color:#f92672>:</span> <span style=color:#a6e22e>IMyFirstSpFxFormProps</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>listItem</span>, <span style=color:#a6e22e>setListItem</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>useState</span>&lt;<span style=color:#f92672>MyListItem</span>&gt;({});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isViewForm</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>useMemo</span>(
</span></span><span style=display:flex><span>    () <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>displayMode</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>FormDisplayMode</span>.<span style=color:#a6e22e>Display</span>,
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>displayMode</span>]
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>onInputChange</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>useMemo</span>(
</span></span><span style=display:flex><span>    () <span style=color:#f92672>=&gt;</span> (<span style=color:#a6e22e>e</span>: <span style=color:#66d9ef>any</span>, <span style=color:#a6e22e>value?</span>: <span style=color:#66d9ef>string</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>setListItem</span>({ ...<span style=color:#a6e22e>listItem</span>, <span style=color:#a6e22e>Title</span>: <span style=color:#66d9ef>value</span> }),
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>listItem</span>, <span style=color:#a6e22e>setListItem</span>]
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>saveForm</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>useMemo</span>(
</span></span><span style=display:flex><span>    () <span style=color:#f92672>=&gt;</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>listItems</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sp</span>.<span style=color:#a6e22e>web</span>.<span style=color:#a6e22e>lists</span>.<span style=color:#a6e22e>getById</span>(
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>list</span>.<span style=color:#a6e22e>guid</span>.<span style=color:#a6e22e>toString</span>()
</span></span><span style=display:flex><span>        ).<span style=color:#a6e22e>items</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>update</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>Title</span>: <span style=color:#66d9ef>listItem.Title</span> };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>listItem</span>.<span style=color:#a6e22e>Title</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#39;Title is required&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>itemId</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>listItems</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>update</span>);
</span></span><span style=display:flex><span>          } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>listItems</span>
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>getById</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>itemId</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>update</span>(<span style=color:#a6e22e>update</span>, <span style=color:#a6e22e>listItem</span>[<span style=color:#e6db74>&#39;odata.etag&#39;</span>]);
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>onSave</span>();
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#39;Error during saving the list item&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      })();
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>listItem</span>, <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>itemId</span>, <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>list</span>.<span style=color:#a6e22e>guid</span>, <span style=color:#a6e22e>sp</span>]
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>useEffect</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>itemId</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>item</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>sp</span>.<span style=color:#a6e22e>web</span>.<span style=color:#a6e22e>lists</span>
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>getById</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>list</span>.<span style=color:#a6e22e>guid</span>.<span style=color:#a6e22e>toString</span>())
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>items</span>.<span style=color:#a6e22e>getById</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>itemId</span>)&lt;<span style=color:#f92672>MyListItem</span>&gt;();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>setListItem</span>(<span style=color:#a6e22e>item</span>);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>setListItem</span>({ <span style=color:#a6e22e>Title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span> });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    })();
</span></span><span style=display:flex><span>  }, [<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>itemId</span>, <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>list</span>.<span style=color:#a6e22e>guid</span>, <span style=color:#a6e22e>displayMode</span>, <span style=color:#a6e22e>sp</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>Stack</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>tokens</span><span style=color:#f92672>=</span>{{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>childrenGap</span>: <span style=color:#66d9ef>15</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>padding</span>: <span style=color:#66d9ef>15</span>,
</span></span><span style=display:flex><span>      }}
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>styles</span><span style=color:#f92672>=</span>{{ <span style=color:#a6e22e>root</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>maxWidth</span>: <span style=color:#66d9ef>500</span> } }}
</span></span><span style=display:flex><span>    &gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>span</span>&gt;<span style=color:#a6e22e>ID</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>itemId</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;new&#39;</span>}&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>TextField</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Title&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>listItem</span>.<span style=color:#a6e22e>Title</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>onInputChange</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>readOnly</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>isViewForm</span>}
</span></span><span style=display:flex><span>      /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Stack</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>horizontal</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>tokens</span><span style=color:#f92672>=</span>{{
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>childrenGap</span>: <span style=color:#66d9ef>5</span>,
</span></span><span style=display:flex><span>        }}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>horizontalAlign</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;end&#34;</span>
</span></span><span style=display:flex><span>      &gt;
</span></span><span style=display:flex><span>        {<span style=color:#f92672>!</span><span style=color:#a6e22e>isViewForm</span> <span style=color:#f92672>&amp;&amp;</span> &lt;<span style=color:#f92672>PrimaryButton</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>saveForm</span>}&gt;<span style=color:#a6e22e>Save</span>&lt;/<span style=color:#f92672>PrimaryButton</span>&gt;}
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>DefaultButton</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>onClose</span>}&gt;<span style=color:#a6e22e>Close</span>&lt;/<span style=color:#f92672>DefaultButton</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Stack</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>Stack</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=debugging-the-form-in-a-browser>Debugging the form in a browser<a hidden class=anchor aria-hidden=true href=#debugging-the-form-in-a-browser>#</a></h3><p>The basic form is ready, and we are eager on testing it. Before trying out how the customizer works you need to change the <code>serve</code> configuration. To do this, edit the <code>config/serve.json</code> file and replace all occurrences of <code>https://contoso.sharepoint.com/sites/mySite</code> with the URL of your test site and <code>/sites/mySite/Lists/MyList</code> with the server relative URL of the test list that you are using. Your final config should be similar to this.</p><p><img loading=lazy src=images/serve_config.png#center alt="serve.json content"></p><p>Now you can run the project with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npx gulp serve
</span></span></code></pre></div><p>The browser should open a development page asking for allowing debug scripts.</p><p><img loading=lazy src=images/allow_debug.png#center alt="Allow debug scripts"></p><p>After allowing debug scripts our form should be opened and ready to add a new item.</p><p><img loading=lazy src=images/form_new.png#center alt="New item form"></p><p>Fill out the title field and click the save button. The form should be closed and a new item is added to the list. So, we got the first big milestone here! The form has created a list item.</p><p><img loading=lazy src=images/created_item.png#center alt="Created list item"></p><p>Let&rsquo;s check if the form works correctly in the &ldquo;View&rdquo; mode. Stop the running <code>serve</code> command and run the view form debugging.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npx gulp serve --config<span style=color:#f92672>=</span>myFirstSpFxForm_ViewForm
</span></span></code></pre></div><p><img loading=lazy src=images/view_form.png#center alt="View form"></p><p>Another successful test! So the last one left. You can try if you can edit an item. Again, stop the <code>serve</code> and run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npx gulp serve --config<span style=color:#f92672>=</span>myFirstSpFxForm_EditForm
</span></span></code></pre></div><p><img loading=lazy src=images/edit_item.png#center alt="Edit form"></p><p>The item loads, now try to edit it and save changes.</p><p><img loading=lazy src=images/edited_item.png#center alt="Edited list item"></p><p>It works! This is your first SPFx form customizer.</p><h2 id=customizer-deployment>Customizer deployment<a hidden class=anchor aria-hidden=true href=#customizer-deployment>#</a></h2><p>To deploy the component you need a content type and update its custom form-related properties. Microsoft introduced these new properties on the content type model:</p><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td>NewFormClientSideComponentId</td><td>component id for new form</td></tr><tr><td>NewFormClientSideComponentProperties</td><td>optional configuration details</td></tr><tr><td>EditFormClientSideComponentId</td><td>component id display form</td></tr><tr><td>EditFormClientSideComponentProperties</td><td>optional configuration details</td></tr><tr><td>DisplayFormClientSideComponentId</td><td>component id display form</td></tr><tr><td>DisplayFormClientSideComponentProperties</td><td>optional configuration details</td></tr></tbody></table><p>You can use various ways to change the content type properties.</p><ul><li>Content-type as part of SPFx package,</li><li>Content-type as part of PnP provisioning template,</li><li>Changing content-type properties with REST or CSOM,</li><li>PnP PowerShell (limited).</li></ul><p>In this article, I will show you how to use the last option on the list above. In fact, it is a combination of using PnP PowerShell to get the access token and making an HTTP request to SharePoint REST API manually. For now, there is no built-in method supporting new content type properties.</p><p>The deployment starts with building the SPFx solution. The SPFx has some very strict linter rules that will stop us from packaging this solution. For this simple PoC purpose add this line to <code>gulpfile.js</code>. Please do not use this in a production environment.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JavaScript data-lang=JavaScript><span style=display:flex><span><span style=color:#a6e22e>build</span>.<span style=color:#a6e22e>addSuppression</span>(<span style=color:#e6db74>/.*/g</span>);
</span></span></code></pre></div><p>Next, you can run this command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npx gulp bundle --ship <span style=color:#f92672>&amp;&amp;</span> npx gulp package-solution --ship
</span></span></code></pre></div><p>You can find the build package in the <code>sharepoint/package-name.sppkg</code> directory. Upload the package to a <a href=https://docs.microsoft.com/en-us/sharepoint/use-app-catalog>tenant or site-scoped app catalog</a>.</p><p><img loading=lazy src=images/app_catalog.png#center alt="App catalog"></p><p>To make the customizer on a SharePoint site you need to add the app. On the home page click the &ldquo;new&rdquo; button and select &ldquo;App&rdquo;.</p><p><img loading=lazy src=images/add_app.png#center alt="Add app"></p><p>On the next page click the &ldquo;Add&rdquo; button next to the solution.</p><p><img loading=lazy src=images/select_app.png#center alt="Selecting app"></p><p>When you will see the success alert, go to site settings and select the content-types option. Then create a new content type.</p><p><img loading=lazy src=images/site_settings.png#center alt="Site settings">
<img loading=lazy src=images/new_content_type.png#center alt="New content type"></p><p>After creating a content type, copy the content-type ID value from the confirmation page.</p><p><img loading=lazy src=images/created_content_type.png#center alt="Created content type"></p><p>Leave the browser for a moment, now it is time for some PowerShell. Connect to a SharePoint site.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Connect-PnPOnline -Url https://tenantname.sharepoint.com/sites/SiteName -Interactive
</span></span></code></pre></div><p>Get the created content type ID and the component ID from the <code>MyFormCustomizer.manfiest.json</code> file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>$contentTypeId <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0x01003D4C996DABD4694BA215125F3C268050&#34;</span>
</span></span><span style=display:flex><span>$componentId <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;83b57037-dfde-4ad3-9ab0-0274c6e26193&#34;</span>
</span></span><span style=display:flex><span>$token <span style=color:#f92672>=</span> Get-PnPAccessToken -ResourceUrl <span style=color:#e6db74>&#34;https://tenantname.sharepoint.com/.default&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$body <span style=color:#f92672>=</span> @<span style=color:#f92672>{</span>NewFormClientSideComponentId <span style=color:#f92672>=</span> $componentId; EditFormClientSideComponentId <span style=color:#f92672>=</span> $componentId; DisplayFormClientSideComponentId <span style=color:#f92672>=</span> $componentId<span style=color:#f92672>}</span> | ConvertTo-Json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Invoke-RestMethod -Method Patch -Uri <span style=color:#e6db74>&#34;https://tenantname.sharepoint.com/sites/SiteName/_api/web/contenttypes(&#39;</span>$contentTypeId<span style=color:#e6db74>&#39;)&#34;</span> -Headers @<span style=color:#f92672>{</span> Authorization <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Bearer </span>$token<span style=color:#e6db74>&#34;</span>; <span style=color:#e6db74>&#34;Content-Type&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;application/json&#34;</span> <span style=color:#f92672>}</span> -Body $body
</span></span></code></pre></div><p>You can close the PowerShell window. Assign the newly created content type to a list. To do this go to <code>List settings -> Advanced settings</code>. Change &ldquo;Allow management of content types?&rdquo; to &ldquo;Yes&rdquo; and save changes.</p><p><img loading=lazy src=images/allow_content_types.png#center alt="Allow management of content types"></p><p>Now &ldquo;Content Types&rdquo; section in the list settings is visible. Click the &ldquo;Add from existing site content types&rdquo; action. On the next page select the previously created content type and click &ldquo;Ok&rdquo;.</p><p><img loading=lazy src=images/add_content_type.png#center alt="Add a content type to a list"></p><p>It is a good idea to hide the default content type. To do this click the &ldquo;Change new button order and default content type&rdquo; link and change the settings to the following.</p><p><img loading=lazy src=images/default_content_type.png#center alt="List default content type settings"></p><p>Now you can try it out by creating a new item. The freshly created form customizer should be your new list form ü•≥</p><p><img loading=lazy src=images/form_new.png#center alt="New item form"></p><p>The tooling at this stage is a little cumbersome. Nevertheless, today is the go-live day of this feature üëç</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://rithala.github.io/tags/sharepoint/>SharePoint</a></li><li><a href=https://rithala.github.io/tags/spfx/>SPFx</a></li><li><a href=https://rithala.github.io/tags/typescript/>TypeScript</a></li></ul><nav class=paginav><a class=next href=https://rithala.github.io/posts/sharepoint-list-items-aggregations-in-power-automate/><span class=title>Next ¬ª</span><br><span>How to aggregate (SUM, AVG, COUNT etc.) SharePoint list items' data efficient in Power Automate</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Build and deploy SPFx form customizer on twitter" href="https://twitter.com/intent/tweet/?text=Build%20and%20deploy%20SPFx%20form%20customizer&url=https%3a%2f%2frithala.github.io%2fposts%2fbuild-and-deploy-spfx-form-customizer%2f&hashtags=SharePoint%2cSPFx%2cTypeScript"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Build and deploy SPFx form customizer on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2frithala.github.io%2fposts%2fbuild-and-deploy-spfx-form-customizer%2f&title=Build%20and%20deploy%20SPFx%20form%20customizer&summary=Build%20and%20deploy%20SPFx%20form%20customizer&source=https%3a%2f%2frithala.github.io%2fposts%2fbuild-and-deploy-spfx-form-customizer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Build and deploy SPFx form customizer on reddit" href="https://reddit.com/submit?url=https%3a%2f%2frithala.github.io%2fposts%2fbuild-and-deploy-spfx-form-customizer%2f&title=Build%20and%20deploy%20SPFx%20form%20customizer"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Build and deploy SPFx form customizer on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frithala.github.io%2fposts%2fbuild-and-deploy-spfx-form-customizer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Build and deploy SPFx form customizer on whatsapp" href="https://api.whatsapp.com/send?text=Build%20and%20deploy%20SPFx%20form%20customizer%20-%20https%3a%2f%2frithala.github.io%2fposts%2fbuild-and-deploy-spfx-form-customizer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Build and deploy SPFx form customizer on telegram" href="https://telegram.me/share/url?text=Build%20and%20deploy%20SPFx%20form%20customizer&url=https%3a%2f%2frithala.github.io%2fposts%2fbuild-and-deploy-spfx-form-customizer%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><div class=utterances></div><script src=https://utteranc.es/client.js repo=rithala/rithala.github.io issue-term=pathname label=Post theme=preferred-color-scheme crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2022 <a href=https://rithala.github.io>Kamil Rithaler</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>